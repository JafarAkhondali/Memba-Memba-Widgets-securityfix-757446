<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>dialogs.assetmanager</title>
    <script>
        window.DEBUG = true;
    </script>
    <!-- Memba fonts -->
    <link href="../../styles/fonts/memba.css" rel="stylesheet">
    <!-- Application theme -->
    <link href="../../styles/themes/app.theme.nordic.css" rel="stylesheet">
    <!-- SystemJS loader -->
    <script src="../../../test/vendor/polyfill.min.js"></script>
    <script src="../../../test/vendor/system.js"></script>
    <script src="../helpers/system.config.js"></script>
    <script>
        (function () {
            'use strict';
            SystemJS.import('kendo.dataviz.diagram')
                .then(function () {
                    // Note: this is a workaround to force early loading of kendo.dataviz.diagram
                    // otherwise we get: Uncaught (in promise) Error: Cannot read property 'Connection' of undefined
                    return Promise.all([
                        SystemJS.import('./dialogs.assetmanager.es6'),
                        SystemJS.import('../helpers/helpers.assets.es6')
                    ]);
                })
                .then(function (modules) {
                    var kendo =  window.kendo;
                    var openAssetManager = modules[0].default;
                    var COLLECTIONS = [
                        modules[1].default.G_COLLECTION,
                        modules[1].default.V_COLLECTION,
                        modules[1].default.X_COLLECTION
                    ];
                    var EXTENSIONS = modules[1].default.IMAGE_EXT;
                    var SCHEMES = modules[1].default.SCHEMES;
                    $(function () {
                        $('#button1').click(function (e) {
                            openAssetManager({
                                title: 'My AssetManager',
                                assets: {
                                    collections: COLLECTIONS,
                                    extensions: EXTENSIONS,
                                    schemes: SCHEMES
                                }
                            }).then(function(result) {
                                $("#console1").append(
                                    kendo.format(
                                        '<div>action `{0}` with data `{1}` at {2}</div>',
                                        result.action,
                                        JSON.stringify(result.data).substr(0, 40), new Date().toLocaleTimeString()
                                    )
                                );
                            });
                        });
                    });
                });
        }());
    </script>
    <style type="text/css">
        .highlight-section {
            margin-top: 10px;
            width: 600px;
            padding: 7px 7px 7px 7px;
            min-height: 35px;
        }
    </style>
</head>

<body>

<h1>dialogs.assetmanager</h1>

<h2>openAssetManager</h2>
<button id="button1" class="k-button">Show Me!</button>
<div id="console1" class="highlight-section k-block" style="margin-top:20px;"></div>

</body>
</html>
