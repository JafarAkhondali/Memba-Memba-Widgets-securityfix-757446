<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>widgets.assetmanager</title>
    <script>
        window.DEBUG = true;
    </script>
    <!-- Memba fonts -->
    <link href="../../styles/fonts/memba.css" rel="stylesheet">
    <!-- Application theme -->
    <link href="../../styles/themes/app.theme.nordic.css" rel="stylesheet">
    <!-- SystemJS loader -->
    <script src="../../../test/vendor/polyfill.min.js"></script>
    <script src="../../../test/vendor/system.js"></script>
    <script src="../helpers/system.config.js"></script>
    <script>
        (function () {
            'use strict';
            Promise.all([
                SystemJS.import('../helpers/helpers.assets.es6'),
                SystemJS.import('./widgets.assetmanager.es6')
            ]).then(function (modules) {
                var kendo = window.kendo;
                var COLLECTIONS = [
                    // modules[0].default.SIMPLE_PROJECT,
                    // modules[0].default.COMPLEX_PROJECT,
                    modules[0].default.G_COLLECTION,
                    modules[0].default.V_COLLECTION,
                    modules[0].default.X_COLLECTION,
                    modules[0].default.GOOGLE_SEARCH
                ];
                var EXTENSIONS = modules[0].default.IMAGE_EXT;
                var SCHEMES = modules[0].default.SCHEMES;
                var assetManager;
                var viewModel = kendo.observable({
                        url: undefined,
                        visible: true,
                        enabled: true,
                        hook: function (e) {
                            // assetManager.unbind('beforeOpen');
                            assetManager.unbind('click');
                            if ($(e.currentTarget).prop('checked')) {
                                assetManager.bind('click', function(e) {
                                    e.preventDefault();
                                    window.alert('You just clicked action ' + e.action);
                                });
                            }
                        }
                    });
                $(function(){
                    assetManager = $('#assets').kendoAssetManager({
                        change: function(e) {
                            viewModel.set('url', e.sender.value());
                        },
                        collections: COLLECTIONS,
                        extensions: EXTENSIONS,
                        schemes: SCHEMES
                    }).data('kendoAssetManager');
                    kendo.bind('body', viewModel);
                });
            });
        }());
    </script>
</head>
<body>
<h1>widgets.assetmanager</h1>
<div id="assets" data-bind="visible: visible, enabled: enabled"></div>

<div>
    <input type="checkbox" data-bind="checked: visible" />Visible&nbsp;
    <input type="checkbox" data-bind="checked: enabled" />Enabled
    <input type="checkbox" data-bind="events: { change: hook }" />Hook
</div>
<pre>
    {
        url: <span data-bind="text: url"></span>,
        visible: <span data-bind="text: visible"></span>,
        enabled: <span data-bind="text: enabled"></span>
    }
</pre>
</body>
</html>
