<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>widgets.stylebar</title>
    <script>
        window.DEBUG = true;
    </script>
    <!-- Memba fonts -->
    <link href="../../styles/fonts/memba.css" rel="stylesheet">
    <!-- Application theme -->
    <link href="../../styles/themes/app.theme.nordic.css" rel="stylesheet">
    <!-- widgets.stylebar stylesheet -->
    <!--link href="../../styles/experiments/widgets.stylebar.css" rel="stylesheet"-->
    <!-- SystemJS loader -->
    <script src="../../../test/vendor/polyfill.min.js"></script>
    <script src="../../../test/vendor/system.js"></script>
    <script src="../helpers/system.config.js"></script>
    <script>
        (function () {
            'use strict';
            Promise.all([
                SystemJS.import('kendo.binder'),
                SystemJS.import('./widgets.stylebar.es6'),
                SystemJS.import('../helpers/helpers.data.es6'),
                SystemJS.import('../data/data.pagecomponent.es6'),
                SystemJS.import('../tools/tools.es6'),
            ]).then(function (modules) {
                var kendo = window.kendo;
                var data = modules[2].getComponentArray();
                var PageComponentDataSource = modules[3].PageComponentDataSource;
                var tools = modules[4].default;
                var promises = data.map(function (component) {
                    // Load tool
                    return tools.load(component.tool);
                });
                $.when.apply($, promises).then(() => {
                    var pageComponentDataSource = new PageComponentDataSource({ data });
                    var viewModel = kendo.observable({
                        components: pageComponentDataSource,
                        selectedComponent: null, // For the stylestrip
                        style: null, // For the stylebar
                        enabled: true,
                        visible: true,
                        reset: function(e) {
                            this.set('selectedComponent', null);
                        }
                    });

                    $(function() {
                        kendo.bind('body', viewModel);
                        pageComponentDataSource.fetch().then(function() {
                            viewModel.set('selectedComponent', pageComponentDataSource.at(0));
                        });
                        // debugger;
                        new kendo.spreadsheet.TabStrip($('#stylebar'))

                    });
                });
            });
        }());
    </script>
    <style>
        body > div:first-of-type {
            height: 22px;
        }

        button {
            margin: 5px 0;
        }
    </style>
</head>
<body>
<h1>widgets.stylebar</h1>
<div id="stylebar" data-bind="value: style, visible: visible, enabled: enabled"></div>
<div style="padding: 20px;">
    <input type="text" data-bind="value: style" class="k-textbox" style="width: 100%;">
    <div>
        <input type="checkbox" data-bind="checked: visible" />Visible&nbsp;
        <input type="checkbox" data-bind="checked: enabled" />Enabled
    </div>
</div>
<div style="padding: 20px;"><div data-bind="attr: { style: style }">Sample Text</div></div>
<button data-bind="click: reset">Clear Selection</button><br/>
<input data-role="dropdownlist" data-bind="source: components, value: selectedComponent" data-text-field="tool" data-value-field="id" style="width: 300px"></select>
</body>
</html>
